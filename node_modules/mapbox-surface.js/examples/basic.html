<!DOCTYPE html>
<html>

<head>
    <title>mapbox-surface.js</title>
    <meta charset='utf-8' />
    <meta name='viewport' content='width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1'>
    <link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.5/mapbox.css' rel='stylesheet' />
    <link rel='stylesheet' href='../dist/mapbox.surface.css' />
    <script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.5/mapbox.js'></script>
    <script src='../dist/mapbox.surface.min.js'></script>
    <style>
    #map {
        position: absolute;
        top: 0;
        bottom: 0;
        height: 100%;
        width: 100%;
    }
    body {
        margin: 0;
        padding: 0;
    }
    </style>
</head>

<body>
    <div id='map'></div>
</body>

<script>
var data = [[34.60876906580382,-119.58189010620117],[34.60453038355465,-119.57639694213866],[34.60241096129153,-119.57588195800781],[34.60043278504442,-119.57502365112303],[34.59704151614417,-119.57244873046874],[34.5949219027687,-119.57056045532227],[34.59223698151803,-119.5667839050293],[34.590823830216586,-119.56438064575194],[34.5871495243434,-119.5616340637207],[34.5863015845293,-119.55854415893553],[34.584888332277814,-119.55562591552734],[34.58319239785046,-119.55305099487305],[34.580789764834705,-119.55099105834961],[34.57796304883451,-119.54961776733398],[34.57683233551799,-119.54927444458006],[34.57626697309206,-119.54652786254883],[34.57428817432136,-119.54172134399414],[34.57315741101919,-119.53845977783203],[34.57273337081576,-119.53433990478517],[34.57287471779053,-119.52987670898438],[34.57188528392067,-119.52507019042967],[34.570330435477956,-119.52232360839842],[34.57004773263718,-119.5192337036133],[34.570754487936846,-119.51391220092772],[34.57174393526374,-119.51082229614258],[34.573298757273044,-119.50841903686523],[34.57697367552368,-119.50824737548828],[34.57909374677031,-119.50927734374999],[34.58036576356307,-119.50927734374999],[34.58206175567162,-119.50653076171874],[34.58333372704127,-119.50515747070311],[34.584888332277814,-119.50498580932617],[34.587714812745794,-119.50498580932617],[34.58983461000389,-119.50807571411133],[34.59039988013903,-119.51030731201172],[34.59039988013903,-119.51374053955077],[34.59039988013903,-119.51562881469727],[34.590541197071914,-119.51751708984375],[34.59124777813088,-119.5199203491211],[34.593367485252614,-119.52180862426756],[34.59463928356551,-119.52266693115234],[34.59647629119911,-119.52438354492186],[34.59859586491132,-119.52695846557616],[34.60029148493807,-119.52713012695314],[34.60368262114034,-119.52833175659178],[34.60537813731427,-119.52833175659178],[34.60735619576234,-119.52833175659178],[34.60947549180879,-119.52833175659178],[34.61145345264612,-119.52833175659178],[34.61286625296409,-119.52833175659178],[34.619647359797206,-119.52919006347656]];
var data2 = [[34.58969329186919,-119.64282989501952],[34.58828009730246,-119.64128494262695],[34.58672555551793,-119.64076995849608],[34.58573628651288,-119.63991165161133],[34.583757713171714,-119.63871002197264],[34.582627078683736,-119.63819503784178],[34.58107243114747,-119.63785171508789],[34.579376418851,-119.63716506958008],[34.57782171051108,-119.63647842407227],[34.57654965478566,-119.6359634399414],[34.575136236704935,-119.63562011718751],[34.57428817432136,-119.63562011718751],[34.57259202360066,-119.6352767944336],[34.57188528392067,-119.63476181030272],[34.5701890841777,-119.63441848754883],[34.56849284983177,-119.63390350341797],[34.56608979194294,-119.63356018066405],[34.565241637284714,-119.63338851928711],[34.56326257610945,-119.63338851928711],[34.56255575713365,-119.63321685791016],[34.56156620047603,-119.63321685791016],[34.56043526416535,-119.63321685791016]];
var singlePoint1 = [34.59704151614417, -119.57244873046874];
var singlePoint2 = [[34.60876906580382, -119.58189010620117]];
var latlngPoint = L.latLng(34.59223698151803, -119.5667839050293);

L.mapbox.accessToken = 'pk.eyJ1IjoiYm9iYnlzdWQiLCJhIjoiZlY0VElqTSJ9.gGJetUgdQKj64oeS5j9kzQ';

var map = L.mapbox.map('map', 'bobbysud.iia43k9m')
    .setView([34.59884537801345, -119.56266693115234], 13);

var surface = L.mapbox.surface();

var surfaceOptions = {
    mapid: 'mapbox.mapbox-terrain-v1',
    layer: 'contour',
    fields: ['ele', 'index']
};

// Get info provides information of a mapid
L.mapbox.surface().getInfo('mapbox.mapbox-terrain-v1', function(error, response) {
    if (error) throw new Error(error);
    console.log(response);
});

// `getData` gets data given a single point
surface.getData(surfaceOptions, singlePoint1, function(error, response) {
    if (error) throw new Error(error);

    L.marker(response.results[0].latlng)
        .bindPopup("I'm a single point with an elevation of " + response.results[0].ele)
        .addTo(map);
});

// `getData` gets data given a single point
surface.getData(surfaceOptions, singlePoint2, function(error, response) {
    if (error) throw new Error(error);
    L.marker(response.results[0].latlng)
        .bindPopup("I'm a single point with an elevation of " + response.results[0].ele)
        .addTo(map);
});

// `getData` gets data given a single L.latlng point
surface.getData(surfaceOptions, latlngPoint, function(error, response) {
    if (error) throw new Error(error);
    L.marker(response.results[0].latlng)
        .bindPopup("I'm a single L.latlng point with an elevation of " + response.results[0].ele)
        .addTo(map);
});

// Request GeoJSON data
surfaceOptions.geojson = true;
surface.getData(surfaceOptions, data2, function(error, response) {
    L.geoJson(response.results, {
        onEachFeature: function(feature, layer) {
            layer.bindPopup('Added via L.geoJson. Elevation: ' + feature.properties.ele.toFixed(0) + 'm');
        }
    }).addTo(map);

    L.mapbox.surface.line({
        color: 'red',
        weight: 8
    }, response.results).addTo(map);
});

// `getData` gets data given an array of points
surfaceOptions.geojson = false;
surface.getData(surfaceOptions, data, function(error, response) {
    if (error) throw new Error(error);

    var elevationChart = L.mapbox.surface.chart({
        position: 'topright',
        chartType: 'area',
        yAxis: {
            data: 'ele',
            units: 'm',
        }
    }, response)
    .addTo(map);

    L.mapbox.surface.line({
        chart: elevationChart,
        color: 'orange',
        weight: 10
    }, response.results).addTo(map);
});
</script>
</html>
